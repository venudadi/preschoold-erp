@startuml system_architecture
!theme spacelab
title Preschool ERP System Architecture

package "Frontend Layer" {
  component "React App (Vite)" as React {
    - App.jsx
    - Role-based Dashboards
    - 40+ UI Components
    - 20+ Pages
    - API Service Layer
  }
}

package "Backend Layer" {
  component "Node.js/Express Server" as Backend {
    - Authentication & Authorization
    - Role-based Access Control
    - JWT + Session Management
    - Rate Limiting & Security
  }

  component "API Routes (26 modules)" as Routes {
    - Auth & User Management
    - Academic Operations
    - Financial Management
    - Communication System
    - Administrative Functions
    - System Management
  }

  component "Middleware" as Middleware {
    - Authentication Middleware
    - Security Middleware
    - Permission Gates
    - Audit Logging
  }

  component "Cloud Storage" as Storage {
    - Document Management
    - Digital Portfolio
    - Receipt Storage
    - File Versioning
  }
}

package "Database Layer" {
  database "MySQL Database" as DB {
    - User Management Tables
    - Academic Data
    - Financial Records
    - Communication Logs
    - Audit Trails
    - Session Management
  }
}

package "External Services" {
  component "Email Service" as Email
  component "SMS Service" as SMS
  component "PDF Generator" as PDF
}

' Connections
React --> Backend : REST API (Axios)\nAuthenticated Requests
Backend --> Routes : Route Handling
Backend --> Middleware : Request Processing
Routes --> DB : SQL Queries\nTransactions
Backend --> Storage : File Operations
Backend --> Email : Notifications
Backend --> SMS : Alerts
Backend --> PDF : Invoice Generation

note right of Backend
  Security Features:
  - JWT with Refresh Tokens
  - Role-based Permissions
  - Rate Limiting
  - Input Validation
  - SQL Injection Prevention
  - 2FA for Sensitive Operations
end note

note right of DB
  Multi-tenant Architecture:
  - Center-based Data Isolation
  - Role-based Access Control
  - Audit Logging
  - Soft Deletes
  - Performance Indexes
end note

@enduml